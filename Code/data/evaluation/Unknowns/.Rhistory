plot(mod.pred$I~mod.pred$t, type='l')
lines(mod.pred$E~mod.pred$t)
lines(mod.pred$S~mod.pred$t)
lines(mod.pred$R~mod.pred$t)
mod.pred <- as.data.frame(lsoda(c(S=500,E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
t
t <- seq(1, 50, by=0.05)
mod.pred <- as.data.frame(lsoda(c(S=500,E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
plot(mod.pred$S)
plot(mod.pred$S, type='l')
lines(mod.pred$I)
lines(mod.pred$E)
lines(mod.pred$R)
fit.model.seir <- edit(fit.model.seir)
rand.params.seir <- edit(rand.params.seir)
fit.model.seir(seir)
rand.params.seir <- edit(rand.params.seir)
fit.model.seir(seir)
dev.off()
fit.model.seir <- edit(fit.model.seir)
save.image("~/epidemics/Code/play.RData")
fit.model.seir <- edit(fit.model.seir)
closed.sir.mdoel
closed.sir.model
sir.model.test <- edit(sir.model.test)
fit.model.test <- edit(fit.model.test)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
require(deSolve)
require(GillespieSSA)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I)
parameters
parameters <- c(0.001, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I)
plot(mod.pred$I, type = 'l')
parameters2 <- c(0.005, 0.12, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
lines(mod.pred2$I)
total
total <- mod.pred$I + mod.pred2$I
plot(total)
plot(total, type='l')
parameters2 <- c(0.0005, 0.12, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
plot(mod.pred2$I)
plot(mod.pred$I)
plot(total, type='l')
parameters2 <- c(0.0008, 0.12, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
total <- mod.pred$I + mod.pred2$I
plot(total)
plot(mod.pred2$I)
plot(mod.pred$I)
parameters2 <- c(0.0012, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
parameters2 <- c(0.0002, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
parameters2 <- c(0.0002, 0.06, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
total <- mod.pred2$I + mod.pred$I
plot(total)
parameters2 <- c(0.002, 0.06, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
total <- mod.pred2$I + mod.pred$I
plot(total, type='l')
parameters <- c(0.0005, 0.1, 500)
plot(mod.pred2$I)
total <- mod.pred2$I + mod.pred$I
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
total <- mod.pred2$I + mod.pred$I
plot(total, type='l')
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.15, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.08, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0005, 0.095, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0008, 0.095, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
total <- mod.pred2$I + mod.pred$I
plot(total, type='l')
parameters <- c(0.001, 01, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.001, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters2 <- c(0.00095, 0.095, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.01, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0003, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0003, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
parameters2 <- c(0.0005, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
plot(total, type='l')
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
parameters
parameters <- c(0.005, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3], I=10, R=0), times=t, sir.model, parameters, hmax=1/120))
plot(mod.pred$I)
parameters2 <- c(0.0005, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters[3], I=10, R=0), times=t, sir.model, parameters2, hmax=1/120))
plot(mod.pred2$I)
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
sir.model2
params2
params2 <- c(0.001, 0.001, 0.1, 0.1, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(c(SS=50000,IS=50, SI=50,II=0,RS=0,RI=0,IR=0,SR=0,RR=0), times=t, sir.model2, params2, hmax=1/120))
omg
y
t
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
y
params2 <- c(0.01, 0.01, 0.1, 0.1, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
params2 <- c(0.001, 0.001, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
params2 <- c(0.002, 0.002, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
params2 <- c(0.005, 0.005, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
plot(omg$xii)
plot(omg$xii~omg$time, type='l')
lines(omg$xss~omg$time, type='l')
coinfection <- edit(sir.model)
save.image("~/epidemics/Code/play.RData")
require(bbmle)
install.packages("bbmle")
dpois?
?
}
?dpois
sir.nll
sir.nll <- function(params, data){}
sir.nll <- edit(sir.nll)
require(deSolve)
sirmodel
sir.model
data
single.sir
partest[[1]] <- c(0.001, 0.1, 500, 1, 1)
partest <- NULL
partest[[1]] <- c(0.001, 0.1, 500, 1, 1)
partest
load("~/epidemics/Code/progress4.RData")
partest
dat
dat <- multiple.epidemics(partest, 100, 200)
dat
plot(dat$I)
sir.nll <- edit(sir.nll)
sir.nll <- edit(sir.nll)
partest1 <- c(log(0.001), log(0.1))
sir.nll(dat,partest1)
sir.nll(partest1, dat)
sir.nll <- edit(sir.nll)
sir.nll <- edit(sir.nll)
sir.model <- edit(sir.model)
sir.nll <- edit(sir.nll)
pred <- as.data.frame(ode(y=c(S=500,I=1,R=0),times=data$time,sir.model,parms=exp(partest1)))
pred
plot(pred$I)
pred <- as.data.frame(ode(y=c(S=500,I=1,R=0),times=dat$time,sir.model,parms=exp(partest1)))
dat
partest
time <- seq(1,100, by=1)
time
pred <- as.data.frame(ode(y=c(S=500,I=1,R=0),times=time,sir.model,parms=exp(partest1)))
pred
plot(pred$I)
sir.nll(partest1, pred)
warnings()
sir.nll <- edit(sir.nll)
sir.nll(partest1, pred)
sir.nll <- edit(sir.nll)
try <- sir.nll(partest1,pred)
try
partest1
partest1 <- c(log(0.0015), log(0.15))
try <- sir.nll(partest1,pred)
try
sir.nll <- edit(sir.nll)
pred
dat <- pred
try <- sir.nll(partest1,dat)
try
partest1 <- c(log(0.001),log(0.1))
try <- sir.nll(partest1,dat)
try
sir.nll <- edit(sir.nll)
pred <- as.data.frame(ode(y=c(S=500,I=1,R=0),times=time,sir.model,parms=exp(partest1)))
plot(pred$I)
pred
as.data.frame(lapply(pred,as.numeric))
pred
as.data.frame(lapply(pred,as.integer))
dat <- pred
sir.nll <- edit(sir.nll)
try <- sir.nll(partest1,dat)
try
warnings()
pred
dat
dat
dat <- as.data.frame(lapply(X,dat.integer))
dat <- as.data.frame(lapply(dat,as.integer))
dat
try <- sir.nll(partest1,dat)
try
plot(try)
sir.nll <- edit(sir.nll)
try <- sir.nll(partest1,dat)
try
partest1
partest1 <- c(log(0.0013), log(0.09))
try <- sir.nll(partest1,dat)
try
sir.nll <- edit(sir.nll)
fit.model
fit0 <- optim(partest1,sir.nll,data=dat);fit0$par
fit0
exo(fit0$par)
exp(fit0$par)
partest1
exp(partest1)
partest1 <- c(log(0.00858), log(0.163723))
fit0 <- optim(partest1,sir.nll,data=dat);fit0$par
exp(fit0$par)
sir.nll
save.image("~/epidemics/Code/progress4.RData")
load("~/epidemics/Code/singleSIR.RData")
mle.sir <- sse.sir
save.image("~/epidemics/Code/singleSIRmle.RData")
mle.sir <- function(params, data){
beta <- exp(params[1])
alpha <- exp(params[2])
mu <- exp(params[3])
gamma <- exp(params[4])
pred <- as.data.frame(ode(y=c(S = 500,E=0, I=1,R=0),times=data$time,seir.model2,parms=c(beta,alpha,mu,gamma)))
logDensities <- dpois(x=data$I,lambda=pred$I,log=TRUE)
nll <- -sum(logDensities)
}
mle.sir <- edit(mle.sir)
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
require(deSolve)
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
sir_90
sir_90[,1]
mle.sir <- edit(mle.sir)
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
warnings()
a
mle.sir <- edit(mle.sir)
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
a
mle.sir <- edit(mle.sir)
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
a
plot(a$I)
lines(sir_90)
mle.sir <- edit(mle.sir)
logDensities <- dpois(x=as.integer(a$I),lambda=sir_90[,2],log=TRUE)
logDensities
exp(-1)
logDensities <- dpois(x=as.integer(a$I),lambda=sir_90[,2],log=TRUE)
mle.sir <- edit(mle.sir)
mle.sir <- edit(mle.sir)
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
a
a <- mle.sir(log(c(0.005,0.1,500)),sir_90)
a
a <- mle.sir(log(c(0.001,0.1,550)),sir_90)
a
a <- mle.sir(log(c(0.001,0.1,650)),sir_90)
a
a <- mle.sir(log(c(0.001,0.11,500)),sir_90)
a
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
a
a <- mle.sir(log(c(0.001,0.1,550)),sir_90)
a
a <- mle.sir(log(c(0.001,0.1,500)),sir_90)
a
a <- mle.sir(log(c(0.0011,0.09,445)),sir_90)
a
fitEpidemicSingleMle <- fitEpidemicSingle
fitEpidemicSingleMle <- edit(fitEpidemicSingleMle)
rand.params <- edit(rand.params)
a <- rand.params()
a
fitEpidemicSingleMle <- edit(fitEpidemicSingleMle)
fitEpidemicSingleMle <- edit(fitEpidemicSingleMle)
fitEpidemicSingleMle <- edit()
fitEpidemicSingleMle <- edit(fitEpidemicSingleMle)
save.image("~/epidemics/Code/singleSIRmle.RData")
load("~/epidemics/Code/singleSIRt0.RData")
load("~/epidemics/Code/singleSIRt0.RData")
sse.sir.t0
closed.sir.model
fitEpidemicSingle.t0 <- edit(fitEpidemicSingle.t0)
save.image("~/epidemics/Code/singleSIRt0.RData")
load("~/epidemics/Code/singleSIR.RData")
fitEpidemicSingle <- edit(fitEpidemicSingle)
save.image("~/epidemics/Code/singleSIR.RData")
load("~/epidemics/Code/singleSIRmle.RData")
fitEpidemicSingleMle <- edit(fitEpidemicSingleMle)
save.image("~/epidemics/Code/singleSIRmle.RData")
load("~/epidemics/Code/multiSIR.RData")
sse.sir.multi <- edit(sse.sir.multi)
library(lineprof)
install.packages("lineprof")
lineprof
library(lineprof)
load("~/epidemics/Code/multiSIR_alternate.RData")
plotGraph <- edit(plotGraph)
load("~/epidemics/Code/multiSIR_alternate.RData")
plotGraph <- edit(plotGraph)
logistic<- function(x,xmin,xmax){
y <- )(xmax-xmin)/(1+exp(-x))) + xmin
y <- ((xmax-xmin)/(1+exp(-x))) + xmin
logistic<- function(x,xmin,xmax){
y <- ((xmax-xmin)/(1+exp(-x))) + xmin
return(y)
}
inverse <- function(y,xmin,xmax){
x <- -log(((xmax-xmin)/(y-xmin))-1)
return(x)
}
logistic(15,20,10)
logistic(15,10,20)
inverse(20,10,20)
inverse(15,10,20)
logistic(0,10,20)
inverse(19.23521,10,20)
logistic(2.491177)
logistic(2.491177,10,20)
logistic(0,10,20)
logistic(-3256235782,10,20)
logistic(3256235782,10,20)
logistic(3256,10,20)
logistic(32,10,20)
logistic(3,10,20)
aic
AICc <- function(sse,n,k){
AIC <- n*log(sse/n) + 2*k
AICc <- AIC + (2*k*(k+1))/(n-k-1)
return(AICc)
}
AICc(5623521,20,3)
AICc(5623521,20,4)
AICc(562352,20,4)
save.image("~/epidemics/Code/logistic.RData")
load("~/epidemics/Code/singleSIR.RData")
robin <- read.csv("~/epidemics/Code/cplusplus/candidatemodels/robin.csv", header=F)
View(robin)
plot(robin)
fitEpidemicSingle(robin)
require(deSolve)
fitEpidemicSingle <- edit(fitEpidemicSingle)
fitEpidemicSingle(robin)
fitEpidemicSingle <- edit(fitEpidemicSingle)
fitEpidemicSingle(robin)
sse.sir <- edit(sse.sir)
fitEpidemicSingle(robin)
fitEpidemicSingle <- edit(fitEpidemicSingle)
fitEpidemicSingle(robin)
sse.sir <- edit(sse.sir)
sse.sir <- edit(sse.sir)
fitEpidemicSingle <- edit(fitEpidemicSingle)
fitEpidemicSingle(robin)
sse.sir <- edit(sse.sir)
params <- c(0.001,0.1,500,0.0005,0.01,800)
sse.sir(params,robin)
params <- log(params)
sse.sir(params,robin)
sse.sir <- edit(sse.sir)
sse.sir(params,robin)
sse.sir <- edit(sse.sir)
sse.sir(params,robin)
sse.sir <- edit(sse.sir)
sse.sir(params,robin)
sse.sir <- edit(sse.sir)
sse.sir(params,robin)
sse.sir <- edit(sse.sir)
sse.sir(params,robin)
sse.sir <- edit(sse.sir)
fitEpidemicSingle(robin)
sse.sir <- edit(sse.sir)
x <- sse.sir(params,robin)
plot(x)
plot(x$I)
lines(robin)
params <- log(0.000148,0.01,1203,0.0000104,0.0622,15373)
params <- log(c(0.000148,0.01,1203,0.0000104,0.0622,15373))
x <- sse.sir(params,robin)
plot(x)
plot(x$I)
lines(robin)
plot(robin)
lines(x)
x
plot(robin)
lines(x$I)
robin1 <- read.csv("~/epidemics/Code/cplusplus/candidatemodels/robin1.csv", header=F)
View(robin1)
plot(robin1)
lines(x$I)
x <- sse.sir(params,robin1)
lines(x)
lines(X$I)
plot(robin1)
lines(x$I)
sse.sir <- edit(sse.sir)
x <- sse.sir(params,robin1)
plot(robin1)
lines(x)
plot(robin1)
lines(x$I)
plot(robin)
lines(x$I)
1.04e-5
1.04e-5
params <- log(c(0.000148,0.01,1203,1.04e-5,0.0622,15373))
x <- sse.sir(params,robin1)
plot(robin1)
lines(x$I)
fitEpidemicSingle(robin1)
fitEpidemicSingle <- edit(fitEpidemicSingle)
fitEpidemicSingle(robin1)
sse.sir <- edit(sse.sir)
fitEpidemicSingle(robin1)
fitEpidemicSingle <- edit(fitEpidemicSingle)
logistic(15,10,20)
logistic(2000,100,150000)
sse.sir <- edit(sse.sir)
sse.sir <- edit(sse.sir)
load("~/epidemics/Code/RSingleFinal/SIRSingle.RData")
rand.params
load("~/epidemics/Code/RSingleFinal/SIRSingle.RData")
fitEpidemicSingle <- edit(fitEpidemicSingle)
fit1 <- optim(par=seed.params, fn=sse.sir, data=sir_1, method = "Nelder-Mead")
plot(sir_1)
seed.params
rand.params
params <- log(c(0.000121,0.2151,3000))
fit1 <- optim(par=seed.params, fn=sse.sir, data=sir_1, method = "Nelder-Mead")
require(deSolve)
fit1 <- optim(par=params, fn=sse.sir, data=sir_1, method = "Nelder-Mead")
fit1
exp(fit1$par)
params <- log(c(0.000121,0.02151,5000))
fit1 <- optim(par=params, fn=sse.sir, data=sir_1, method = "Nelder-Mead")
fit1
exp(fit1$par)
params <- log(c(0.000721,0.11151,1100))
fit1 <- optim(par=params, fn=sse.sir, data=sir_1, method = "Nelder-Mead")
fit1
params <- log(c(0.00176,0.094,1600))
fit1 <- optim(par=params, fn=sse.sir, data=sir_1, method = "Nelder-Mead")
allh3 <- read.delim("~/epidemics/Code/data/evaluation/CDC/allh3.csv", header=F)
View(allh3)
plot(allh3)
all1 <- read.delim("~/epidemics/Code/data/evaluation/CDC/all1.csv", header=F)
View(all1)
plot(all1)
all1
all1[40:150,]
plot(all1[40:150,])
plot(all1[30:150,])
plot(all1[35:150,])
plot(all1[40:150,])
x <- all1[40:150,]
write.table(x,"all_flu.csv",sep=',')
setwd("~/epidemics/Code/data/evaluation/Unknowns")
write.table(x,"all_flu.csv",sep=',')
