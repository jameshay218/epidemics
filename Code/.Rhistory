plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.15, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.08, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0005, 0.095, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0008, 0.095, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
total <- mod.pred2$I + mod.pred$I
plot(total, type='l')
parameters <- c(0.001, 01, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.001, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters2 <- c(0.00095, 0.095, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.01, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0003, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0003, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
parameters2 <- c(0.0005, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
plot(total, type='l')
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
parameters
parameters <- c(0.005, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3], I=10, R=0), times=t, sir.model, parameters, hmax=1/120))
plot(mod.pred$I)
parameters2 <- c(0.0005, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters[3], I=10, R=0), times=t, sir.model, parameters2, hmax=1/120))
plot(mod.pred2$I)
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
sir.model2
params2
params2 <- c(0.001, 0.001, 0.1, 0.1, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(c(SS=50000,IS=50, SI=50,II=0,RS=0,RI=0,IR=0,SR=0,RR=0), times=t, sir.model2, params2, hmax=1/120))
omg
y
t
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
y
params2 <- c(0.01, 0.01, 0.1, 0.1, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
params2 <- c(0.001, 0.001, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
params2 <- c(0.002, 0.002, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
params2 <- c(0.005, 0.005, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
plot(omg$xii)
plot(omg$xii~omg$time, type='l')
lines(omg$xss~omg$time, type='l')
coinfection <- edit(sir.model)
save.image("~/epidemics/Code/play.RData")
plot(total)
plot(total, type='l')
coinfection <- edit(coinfection)
two.epidemics
load("~/epidemics/Code/play.RData")
two.epidemics
setwd("~/epidemics/Code")
total <- two.epidemics(params2, params)
require(deSolve)
require(GillespieSSA)
total <- two.epidemics(params2, params)
plot(total, type='l')
two.epidemics <- edit(two.epidemics)
multiple.epidemics <- function(all.params){
for(i in 1:nrow(all.params)){
}
}
multiple.epidemics <- edit(two.epidemics)
parameters <- c(params, params2)
parameters
parameters <- list(1=params, 2=params2)
parameters <- list('1'=params, '2'=params2)
parameters
multiple.epidemics <- edit(two.epidemics)
multiple.epidemics
multiple.epidemics
multiple.epidemics
multiple.epidemics <- edit(two.epidemics)
multiple.epidemics <- edit()
multiple.epidemics <- edit()
multiple.epidemics <- edit()
multiple.epidemics <- edit()
multiple.epidemics <- edit()
multiple.epidemics <- edit()
parameters <- c(params, params2)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(two.epidemics)
multiple.epidemics
multiple.epidemics <- edit()
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
parameters <- list(params, params2)
test <- multiple.epidemics(parameters)
nrow(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
params <- c(0.0008, 0.1, 1000, 10, 1)
params2 <- c(0.005, 0.1, 500, 10, 1)
parameters <- list(params, params2)
test <- multiple.epidemics(parameters)
parameters[1]
parameters[1][5]
parameters[1][4]
parameters[[1]][4]
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
test[1]
test[2]
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
params2 <- c(0.005, 0.1, 500, 10, 15)
parameters <- list(params, params2)
test <- multiple.epidemics(parameters)
print(test)
seq(1,1,by=0.05)
plot(test[[1]])
plot(test[[2]])
multiple.epidemics <- edit(multiple.epidemics)
test<- multiple.epidemics(parameters)
plot(test[[1]])
plot(test[[2]])
plot(test[[2]]+test[[1]])
hiya <- test[[1]] + test[[2]]
plot(hiya)
hiya[1:15,]
hiya[-15:,]
hiya[50:-15,]
hiya[50:,]
hiya[50:100,]
hiya
hiya[1:10,]
test[[1]][1:10,]
seq(1,0.95,by=0.05)
seq(0.95,1,by=0.05)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test[[2]][1:25,]
test[[2]][1:250,]
test[[2]]
test[[1]]
multiple.epidemics <- edit(multiple.epidemics)
multiple.epidemics <- edit()
test <- multiple.epidemics(parameters)
plot(test)
test
test[1]
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test
test[1]
test2
test[2]
test[1][1:10,]
test[[1]][1:10,]
test[[2]][1:10,]
multiple.epidemics <- edit(multiple.epidemics)
parameters
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters)
test[[1]][1:10,]
test[[2]][1:10,]
test[[1]][250:400,]
test[[2]][250:400,]
plot(test[[1]]+test[[2]])
plot(test[[1]]+test[[2]], type='l')
params
params3 <- c(0.003, 0.11, 1500, 10, 30)
parameters <- list(params, params2, params3)
test <- multiple.epidemics(parameters)
plot(test[[1]]+test[[2]]+test[[3]],type='l')
multiple.epidemics <- edit(multiple.epidemics)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters, 100, 250)
test <- multiple.epidemics(parameters, 150, 250)
test <- multiple.epidemics(parameters, 150, 175)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters, 150, 175)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters, 150, 175)
test <- multiple.epidemics(parameters, 150, 300)
multiple.epidemics <- edit(multiple.epidemics)
multiple.epidemics <- edit(multiple.epidemics)
sum(test)
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters, 150, 300)
plot(test)
plot(test, type='l')
test <- multiple.epidemics(parameters, 100, 250)
plot(test, type='l')
multiple.epidemics <- edit(multiple.epidemics)
test <- multiple.epidemics(parameters, 100, 250)
plot(test)
plot(test, type='l')
params4 <- c(0.008,0.12,2000,20,60)
parameters <- c(params, params2, params3, params4)
test <- multiple.epidemics(parameters,100,250)
parameters
parameters <- list(params, params2, params3, params4)
test <- multiple.epidemics(parameters,100,250)
plot(test,type='l')
parameters <- list(params4, params2, params3, params)
test <- multiple.epidemics(parameters,100,250)
plot(tset.type='l')
plot(test,type='l')
params4 <- c(0.001,0.12,2000,20,60)
parameters <- list(params4, params2, params3, params)
test <- multiple.epidemics(parameters,100,250)
plot(test,type='l')
params4 <- c(0.0005,0.12,2000,20,60)
parameters <- list(params4, params2, params3, params)
test <- multiple.epidemics(parameters,100,250)
plot(test,type='l')
params4 <- c(0.0005,0.12,600,10,60)
parameters <- list(params4, params2, params3, params)
test <- multiple.epidemics(parameters,100,250)
plot(test,type='l')
params3
params3 <- c(0.003, 0.1, 1000,10,30)
parameters <- list(params4, params2, params3, params)
test <- multiple.epidemics(parameters,100,250)
plot(test,type='l')
params4
params4 <- c(0.0005, 0.12, 600, 5,60)
parameters <- list(params4, params2, params3, params)
test <- multiple.epidemics(parameters,100,250)
plot(test,type='l')
multiple.epidemics.ssa <- edit(multiple.epidemics)
sse.sir
lots.ssa <- edit(lots.ssa)
single.ssa <- edit(lots.ssa)
parms <- c(beta=.001, gamma=.100)
# Define system
x0 <- c(S=500, I=1, R=0)                      # Initial state vector
nu <- matrix(c(-1,0,1,-1,0,1),nrow=3,byrow=T) # State-change matrix
a  <- c("beta*S*I", "gamma*I")                # Propensity vector
tf <- 100                                     # Final time
simName <- "Kermack-McKendrick SIR"
# Run the simulations
nf <- layout(matrix(c(1,2,3,4),ncol=2, byrow=T))
# Direct method
set.seed(2)
out <- ssa(x0,a,nu,parms,tf,method="D",simName,verbose=TRUE,consoleInterval=1)
out
out$data
single.ssa <- edit(lots.ssa)
single.ssa <- edit(single.ssa)
hi <- single.ssa(params)
hi <- single.ssa(params,params[4],100)
plot(hi)
hi
plot(hi$I)
plot(hi[,3])
plot(hi[,3], type='l')
single.ssa <- edit(single.ssa)
test
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
single.ssa <- edit(single.ssa)
hi <- single.ssa(params,params[4],100)
hi
lots.ssa <- edit(lots.ssa)
hi <- single.ssa(params,params[4],100)
hi
hi <- as.data.frame(single.ssa(params,params[4],100))
hi
hi <- unique(single.ssa(params, params[4], 100))
hi
hi <- as.data.frame(hi)
hi
duplicated(hi)
hi[duplicated(hi)]
hi
hi <- unique(single.ssa(params, params[4], 100))
hi
typeof(hi)
hi
hello$time <- hi[,1]
hello
hello <- NULL
hello$time <- hi[,1]
hello
hello$I <- hi[,3]
hello
hello$I[1]
hello$I[2]
plot(hello$I)
hello$I <- hello$I + 10
plot(hello$I)
plot(hello$I,type='l')
hello$I[1]
hello$I[3]
hello$I[2]
hello$I[67]
hello$I[1]
hello$I[1] <- hello$I[1] + 10
hello$I[1]
hello$I <- as.vector(hello$I)
hello$I]
hello$I
hello
hi <- unique(single.ssa(params, params[4], 100))
hi
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
hi
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
hi
hi[[1]]
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi[[1]]
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
hi
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi
hi <- multiple.epidemics.ssa(parameters, 100, 250)
hi
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
multiple.epidemics.ssa <- edit()
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
single.ssa <- edit(single.ssa)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
hi
plot(hi, type='l')
plot(hi, type='l')
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi2 <- multiple.epidemics.ssa(parameters, 100, 250)
lines(hi2, type='l')
plot(hi2, type='l')
plot(hi2, type='l')
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
parameters
parameters[[3]][5] <- 20
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
plot(hi, type='l')
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
single.ssa <- edit(single.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
plot(hi, type='l')
hi
hi[[1]]
hi[[1]]$I[1;200,]
hi[[1]][1;200,]
hi[[1]]
hi[1:200,]
single.ssa <- edit(single.ssa)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
plot(hi, type='l')
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
single.ssa <- edit(single.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
plot(hi, type='l')
single.ssa <- edit(single.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
plot(hi, type='l')
hi
hi$time <- hi$time*10
hi
plot(hi, type='l')
single.ssa <- edit(single.ssa)
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
hi
hi
plot(hi, type='l')
parameters
params3[[3]][1] <- 0.001
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
parameters <- c(params,params2,params3,params4)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
parameters <- list(params,params2,params3,params4)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi, type='l')
plot(hi, type='l')
params3
params
params[5] <- 25
parameters <- list(params,params2,params3,params4)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi)
plot(hi,type='l')
plot(hi,type='l')
params2
params2[1] <- 0.002
parameters <- list(params,params2,params3,params4)
hi <- multiple.epidemics.ssa(parameters, 100, 250)
plot(hi,type='l')
plot(hi,type='l')
multiple.epidemics.ssa <- edit(multiple.epidemics.ssa)
fit.model.test <- edit(fit.model.test)
hi
fit.model.test <- edit(fit.model.test)
save.image("~/epidemics/Code/play.RData")
