load("~/epidemics/Code/play.RData")
plot(mod.pred$I)
mod.pred
seir.model
fit.model.seir <- edit(fit.model.seir)
mod.pred <- as.data.frame(lsoda(c(S=parameteters[4],E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
require(deSolve)
require(GillespieSSA)
mod.pred <- as.data.frame(lsoda(c(S=parameteters[4],E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
mod.pred <- as.data.frame(lsoda(c(S=parameters[4],E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
plot(mod.pred$I)
mod.pred
parameters
fit.model.seir <- edit(fit.model.seir)
seir.model <- edit(seir.model)
I0 = 10
mod.pred <- as.data.frame(lsoda(c(S=parameters[4],E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
plot(mod.pred$I)
mod.pred
mod.pred <- as.data.frame(lsoda(c(S=500,E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
mod.pred
seir.model <- edit(seir.model)
t
knownseir
t <- seq(1, max(knownseir$t),by=0.05)
mod.pred <- as.data.frame(lsoda(c(S=500,E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
mod.pred
plot(mod.pred$I)
fit.model.seir <- edit(fit.model.seir)
fit.mode.seir(seir)
fit.model.seir(seir)
fit.mode.seir(seir)
fit.model.seir <- edit(fit.model.seir)
fit.mode.seir(seir)
fit.model.seir(seir)
fit.model.seir <- edit(fit.model.seir)
rand.params.seir <- edit(rand.params.seir)
log(0.5)
log(0.01)
log(0.9)
rand.params.seir <- edit(rand.params.seir)
fit.model.seir(seir)
seir.mdoel
seir.model
sse.seir
mod.pred
plot(mod.pred$I~mod.pred$t)
plot(mod.pred$I~mod.pred$t, type='l')
lines(mod.pred$E~mod.pred$t)
lines(mod.pred$S~mod.pred$t)
lines(mod.pred$R~mod.pred$t)
mod.pred <- as.data.frame(lsoda(c(S=500,E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
t
t <- seq(1, 50, by=0.05)
mod.pred <- as.data.frame(lsoda(c(S=500,E=0,I=I0,R=0),times=t,seir.model,parameters,hmax=1/120))
plot(mod.pred$S)
plot(mod.pred$S, type='l')
lines(mod.pred$I)
lines(mod.pred$E)
lines(mod.pred$R)
fit.model.seir <- edit(fit.model.seir)
rand.params.seir <- edit(rand.params.seir)
fit.model.seir(seir)
rand.params.seir <- edit(rand.params.seir)
fit.model.seir(seir)
dev.off()
fit.model.seir <- edit(fit.model.seir)
save.image("~/epidemics/Code/play.RData")
fit.model.seir <- edit(fit.model.seir)
closed.sir.mdoel
closed.sir.model
sir.model.test <- edit(sir.model.test)
fit.model.test <- edit(fit.model.test)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
require(deSolve)
require(GillespieSSA)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I)
parameters
parameters <- c(0.001, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I)
plot(mod.pred$I, type = 'l')
parameters2 <- c(0.005, 0.12, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
lines(mod.pred2$I)
total
total <- mod.pred$I + mod.pred2$I
plot(total)
plot(total, type='l')
parameters2 <- c(0.0005, 0.12, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
plot(mod.pred2$I)
plot(mod.pred$I)
plot(total, type='l')
parameters2 <- c(0.0008, 0.12, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
total <- mod.pred$I + mod.pred2$I
plot(total)
plot(mod.pred2$I)
plot(mod.pred$I)
parameters2 <- c(0.0012, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
parameters2 <- c(0.0002, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
parameters2 <- c(0.0002, 0.06, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
total <- mod.pred2$I + mod.pred$I
plot(total)
parameters2 <- c(0.002, 0.06, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I)
total <- mod.pred2$I + mod.pred$I
plot(total, type='l')
parameters <- c(0.0005, 0.1, 500)
plot(mod.pred2$I)
total <- mod.pred2$I + mod.pred$I
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
total <- mod.pred2$I + mod.pred$I
plot(total, type='l')
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.15, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.08, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0002, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0005, 0.095, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.0008, 0.095, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
total <- mod.pred2$I + mod.pred$I
plot(total, type='l')
parameters <- c(0.001, 01, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters <- c(0.001, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3],I=I0,R=0),times=t,sir.model,parameters,hmax=1/120))
plot(mod.pred$I, type='l')
parameters2 <- c(0.00095, 0.095, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.01, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0003, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0003, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
parameters2 <- c(0.0005, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
parameters2 <- c(0.0005, 0.05, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters2[3],I=I0,R=0),times=t,sir.model,parameters2,hmax=1/120))
plot(mod.pred2$I, type='l')
plot(total, type='l')
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
parameters
parameters <- c(0.005, 0.1, 500)
mod.pred <- as.data.frame(lsoda(c(S=parameters[3], I=10, R=0), times=t, sir.model, parameters, hmax=1/120))
plot(mod.pred$I)
parameters2 <- c(0.0005, 0.1, 500)
mod.pred2 <- as.data.frame(lsoda(c(S=parameters[3], I=10, R=0), times=t, sir.model, parameters2, hmax=1/120))
plot(mod.pred2$I)
total <- mod.pred$I + mod.pred2$I
plot(total, type='l')
sir.model2
params2
params2 <- c(0.001, 0.001, 0.1, 0.1, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(c(SS=50000,IS=50, SI=50,II=0,RS=0,RI=0,IR=0,SR=0,RR=0), times=t, sir.model2, params2, hmax=1/120))
omg
y
t
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
y
params2 <- c(0.01, 0.01, 0.1, 0.1, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
params2 <- c(0.001, 0.001, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
params2 <- c(0.002, 0.002, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
params2 <- c(0.005, 0.005, 0.5, 0.5, 0.0001, 0.0001)
omg <- as.data.frame(lsoda(y, times=t, sir.model2, params2, hmax=1/120))
omg
plot(omg$xii)
plot(omg$xii~omg$time, type='l')
lines(omg$xss~omg$time, type='l')
coinfection <- edit(sir.model)
save.image("~/epidemics/Code/play.RData")
plot(test3, type='l')
plot(test2, type='l')
load("~/epidemics/Code/progress.RData")
plot(test2, type='l')
plot(test3, type='l')
plot(test2, type='l')
detect.epidemic <- edit(detect.epidemic)
detect.epidemic <- edit(detect.epidemic)
test2
setwd("~/epidemics/Code/overlaptest/blah")
detect.epidemic(test2,params,67)
require(deSolve)
detect.epidemic(test2,params,67)
detect.epidemic(test2,log(params),67)
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67)
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67)
detect.epidemic(test2,log(params),67)
abline(v=42)
plot(test2, type='l')
abline(v=42)
dev.off()
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67)
detect.epidemic <- edit(detect.epidemic)
test2
plot(test2,type='l')
dev.off()
plot(test2,type='l')
dev.off()
plot(test2, type='l')
abline(v=67)
detect.epidemic <- edit(detect.epidemic)
sir.model <- edit(sir.model)
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67)
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67)
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67)
mod.pred
mod.pred[nrow(mod.pred)-15:nrow(mod.pred),]
mod.pred[(nrow(mod.pred)-15):nrow(mod.pred),]
test2[(nrow(test2)-15):nrow(test2),]
mod.pred[(nrow(mod.pred)-15):nrow(mod.pred),]
detect.epidemic <- edit(detect.epidemic)
mod.pred <- detect.epidemic(test2,log(params),67)
mod.pred
plot(mod.pred$I)
lines(test2)
plot(mod.pred$I~mod.pred$time)
lines(test2)
lines(test2~mod.pred$time)
test2
plot(test2)
plot(test2, type='l')
lines(mod.pred$I~mod.pred$t)
mod.pred
mod.pred[1:10,]
lines(mod.pred$I~(mod.pred$t-1)
)
detect.epidemic <- edit(detect.epidemic)
mod.pred <- detect.epidemic(test2,log(params),67)
detect.epidemic <- edit(detect.epidemic)
mod.pred <- detect.epidemic(test2,log(params),67)
detect.epidemic <- edit(detect.epidemic)
parameters
mod.pred <- detect.epidemic(test2,log(params),67,30)
test2
test2
test3
plot(test2)
lines(test3)
plot(test2[,2]~test[,1])
plot(test2[2,]~test[1,])
plot(test2[,2]~test2[,1])
plot(test2[,2]~test2[,1], type='l')
lines(test3[,2]~test3[,1])
params
parameters
multiple.epidemics <- edit(multiple.epidemics)
parameters2
parameters2 <- list(params)
test4 <- multiple.epidemics(params,100,250)
test4 <- multiple.epidemics(params,100,200)
parameters
parameters2
multiple.epidemics <- edit(multiple.epidemics)
parameters2[[1]][5]
multiple.epidemics <- edit(multiple.epidemics)
parameters2[[1]][5]+100
multiple.epidemics <- edit(multiple.epidemics)
test4 <- multiple.epidemics(parameters2,100,200)
plot(test4)
lines(test3)
lines(test2)
test2 <- multiple.epidemics(parameters, 100, 200)
plot(test4)
plot(test4, type='l')
lines(test2)
multiple.epidemics <- edit(multiple.epidemics)
test4
test2
multiple.epidemics <- edit(multiple.epidemics)
test2 <- multiple.epidemics(parameters, 100, 200)
plot(test2[[1]])
lines(test2[[2]])
result
result <- test2[[1]] + test2[[2]]
test2
plot(result)
multiple.epidemics <- edit(multiple.epidemics)
result <- result[[1]][,2] + result[[2]][,2]
result1 <- result[[1]][,2] + result[[2]][,2]
nrow(result[[1]])
result
test2 <- multiple.epidemics(parameters, 100, 200)
result <- test2[[1]][,2] + test2[[2]][,2]
plot(result)
result
test2[[1]]
test2
plot(test2)
plot(test2[,2]~test2[,1])
test2
result
multiple.epidemics <- edit(multiple.epidemics)
test2 <- multiple.epidemics(parameteres,100,200)
test2 <- multiple.epidemics(parameters,100,200)
test2
multiple.epidemics <- edit(multiple.epidemics)
test2 <- multiple.epidemics(parameters,100,200)
test2
plot(test2)
multiple.epidemics <- edit(multiple.epidemics)
lines(test3)
detect.epidemic <- edit(detect.epidemic)
detect.epidemic <- edit()
detect.epidemic(test2,log(params),67,30)
detect.epidemic <- edit(detect.epidemic)
test2
test2[nrow(test2)][1]
test2[nrow(test2),][1]
detect.epidemic <- edit(detect.epidemic)
test2[nrow(test2),]
test2[nrow(test2),][2]
test2[nrow(test2),][1]
test2[nrow(test2),][1]+3
detect.epidemic(test2,log(params),67,30)
detect.epidemic <- edit(detect.epidemic)
a <- test2[nrow(test2),][1]
a
a[1]
a[2]
a$time
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67,30)
parameters
detect.epidemic <- edit(detect.epidemic)
detect.epidemic(test2,log(params),67,30)
mod.pred
test2
detect.epidemic <- edit(detect.epidemic)
mod.pred <- detect.epidemic(test2, params, 30, 67)
mod.pred <- detect.epidemic(test2, log(params), 30, 67)
mod.pred
mod.pred$time
mod.pred$time[100]
detect.epidemic <- edit(detect.epidemic)
detect.epidemic <- edit(detect.epidemic)
mod.pred <- detect.epidemic(test2, log(params))
mod.pred
test2
test2[,1][3]
test2[,1][30]
detect.epidemic <- edit(detect.epidemic)
detect.epidemic <- edit(detect.epidemic)
detect.epidemic <- edit(detect.epidemic)
detect <- detect.epidemic
detect <- edit(detect)
realtime.fit <- edit(realtime.fit)
detect <- edit(detect)
realtime.fit <- edit(realtime.fit)
fit.model.test <- edit(fit.model.test)
data
synth
fit.model.test(synth)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth)
fit.model.test <- edit(fit.model.test)
synth
synth2 <- synth
synth2$t <- synth2$t + 15
synth2
newrow <- list(t=seq(1,15,by=1),I=seq(1,15,by=1))
newrow
newrow <- data.frame(t=seq(1,15,by=1),I=seq(1,15,by=1))
newrow
synth2 <- rbind(newrow,synth2)
synth2
synth2$I[1:15] <- 1
synth2
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test <- edit(fit.model.test)
detect <- edit(detecty)
detect <- edit(detect)
fit.model.test <- edit(fit.model.test)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
sse.sir.single <- edit(sse.sir.single)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
residuals <- list()
residuals
residuals <- c(0)
residuals
residuals <- c()
residuals
length(residuals)
residuals[0]
length(residuals)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
install.packages("foreach")
require(foreach)
foreach(i in 1:10) %dopar%{
foreach(i=1:10) %dopar%{
print('hello')
}
a = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
a
foreach(i=1:10) %dopar%{
a[i] <- a[i] + 10
}
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
synth
temp
temp <- head(synth,20)
fit.model.test <- edit(fit.model.test)
temp
temp - 15
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
sse.sir2 <- sse.sir
sse.sir2 <- edit(sse.sir2)
fit.model.test <- edit(fit.model.test)
fit.model.tset(synth)
fit.model.test(synth)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth)
fit.model.test(synth)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth)
synth2
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
fit.model.test(synth2)
fit.model.test <- edit(fit.model.test)
sse.sir.single <- edit(sse.sir.single)
sse.sir <- edit(sse.sir)
sse.sir2 <- edit(sse.sir2)
save.image("~/epidemics/Code/progress.RData")
